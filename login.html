<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" type="image/png" href="https://image2url.com/images/1763794303332-e56109c1-b1ab-4fe0-9530-70bfdda1b4a9.png">
<link rel="apple-touch-icon" href="https://image2url.com/images/1763794303332-e56109c1-b1ab-4fe0-9530-70bfdda1b4a9.png">

<title>Roomofy - Login / Signup</title>
<style>
 
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@400;500;600&display=swap');

  body {
    font-family: 'Montserrat', 'Poppins', Arial, sans-serif;
    background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    overflow: hidden;
    color: #3e2723;
  }

  .container {
    position: relative;
    z-index: 1;
    width: 360px;
    padding: 32px;
    border-radius: 18px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(12px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    border: 1px solid rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .container img {
    border-radius: 14px;
    width: 100%;
    max-width: 260px;
    margin-bottom: 20px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.15);
    transition: transform 0.3s ease;
  }
  .container img:hover { transform: scale(1.03); }

  h2 {
    font-family: 'Playfair Display', serif;
    font-size: 28px;
    margin-bottom: 18px;
    text-align: center;
    font-weight: 600;
    color: #6d1b1b; /* maroon */
    letter-spacing: 1px;
    text-transform: uppercase;
    border-bottom: 2px solid #a1887f;
    padding-bottom: 8px;
    width: 100%;
  }

  form {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 14px;
    align-items: center;
  }

  input {
    width: 100%;
    padding: 12px 14px;
    border-radius: 10px;
    border: 1.5px solid #a1887f;
    font-size: 15px;
    background: #fafafa;
    color: #3e2723;
    transition: all 0.3s ease;
  }
  input:focus {
    border-color: #6d1b1b;
    box-shadow: 0 0 6px rgba(109,27,27,0.3);
    outline: none;
  }

  button {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    background: linear-gradient(135deg, #8d6e63, #6d1b1b);
    color: #fff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
  }
  button:hover {
    background: linear-gradient(135deg, #6d1b1b, #3e2723);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.3);
  }

  .toggle-link {
    font-weight: 600;
    cursor: pointer;
    color: #6d1b1b;
    text-decoration: underline;
    transition: color 0.3s;
  }
  .toggle-link:hover { color: #3e2723; }

  .message {
    font-size: 14px;
    min-height: 18px;
    text-align: center;
  }
  .message.success { color: #2e7d32; }
  .message.error { color: #c62828; }

  .extra-links {
    margin-top: 15px;
    text-align: center;
    font-size: 14px;
    color: #5d4037;
  }
  .extra-links a {
    color: #6d1b1b;
    text-decoration: none;
    margin: 0 6px;
    font-weight: 600;
    transition: all 0.3s;
  }
  .extra-links a:hover { color: #3e2723; text-decoration: underline; }

  #processing, #contactMsg {
    font-weight: bold;
    text-align: center;
    color: #6d1b1b;
    margin-top: 10px;
  }

  #fadingLines {
    min-height: 20px;
    margin: 6px 0;
    color: #5d4037;
    font-weight: 600;
    text-align: center;
  }

  @media (max-width: 420px) {
    .container { width: 90%; padding: 24px; }
    h2 { font-size: 22px; }
    input, button { font-size: 14px; padding: 10px; }
  }


</style>

</head>
<body>

<div class="container">
  <img src="https://i.ibb.co/7xfPJNfR/Gemini-Generated-Image-hj2mc2hj2mc2hj2m.png" alt="Family Banner">
    <p class="toggle-link" id="showSignup">Don't have an account? Signup here</p>

  <div id="processing" style="display:none;">Processing your request... <span id="timer">60</span>s left</div>
  <div id="contactMsg" style="display:none;">Login not completed. Please contact <b>roomofyonline@gmail.com</b></div>
  <div id="fadingLines"></div>

  <form id="loginForm">
    <h2>Roomofy Login</h2>
    <input type="text" id="loginMobile" placeholder="Mobile number" required pattern="\d{10}" />
    <input type="password" id="loginPassword" placeholder="Password" required minlength="6"/>
    <button type="submit" id="loginBtn">Login</button>
    <p class="message" id="loginMessage"></p>
    <p class="toggle-link" id="showSignup">Don't have an account? Signup here</p>
  </form>

  <form id="signupForm" style="display:none;">
    <h2>Signup</h2>
    <input type="text" id="signupMobile" placeholder="Mobile number" required pattern="\d{10}" />
    <input type="password" id="signupPassword" placeholder="Password" required minlength="6"/>
    <input type="password" id="signupConfirmPassword" placeholder="Confirm Password" required minlength="6"/>
    <button type="submit" id="signupBtn">Signup</button>
    <p class="message" id="signupMessage"></p>
    <p class="toggle-link" id="showLogin">Already have an account? Login here</p>
  </form>

  <div class="extra-links">
    <a href="privacy.policy.html" target="_blank">Privacy Policy</a> | 
    <a href="terms-and-conditions.html" target="_blank">Terms & Conditions</a> | 
    <a href="about.html" target="_blank">About Us</a> | 
    <a href="how to use.html" target="_blank">How to Use</a>
  </div>
</div>

<script>
const API_BASE = window.location.hostname.includes('localhost') 
  ? 'http://localhost:5000/api'
  : 'https://roomofy-app-1.onrender.com/api';

const loginForm = document.getElementById('loginForm');
const signupForm = document.getElementById('signupForm');
const loginMessage = document.getElementById('loginMessage');
const signupMessage = document.getElementById('signupMessage');
const showSignupLink = document.getElementById('showSignup');
const showLoginLink = document.getElementById('showLogin');
const loginMobileInput = document.getElementById('loginMobile');
const loginBtn = document.getElementById('loginBtn');
const signupBtn = document.getElementById('signupBtn');
const processingDiv = document.getElementById('processing');
const contactMsg = document.getElementById('contactMsg');
const fadingLinesDiv = document.getElementById('fadingLines');

let countdown = null;
let lineTimer = null;
let lineIndex = 0;
let isTimerRunning = false; // initial false, taaki start ho sake

const lines = [
  "We provide the best rooms for your family.",
  "Trusted by thousands of happy customers.",
  "Secure and verified listings.",
  "Find rooms near your favorite locations.",
  "Easy and fast booking process.",
  "Affordable prices without compromise.",
  "Check verified reviews before booking.",
  "Customer support always ready for you.",
  "Rooms that feel like home.",
  "Join our community of happy tenants."
];

// Toggle forms
showSignupLink.addEventListener('click', () => {
  loginForm.style.display = 'none';
  signupForm.style.display = 'flex';
  stopTimerAndLines();
  clearMessages();
});

showLoginLink.addEventListener('click', () => {
  signupForm.style.display = 'none';
  loginForm.style.display = 'flex';
  stopTimerAndLines();
  clearMessages();
});

function clearMessages() {
  loginMessage.textContent = '';
  signupMessage.textContent = '';
  loginMessage.classList.remove('success','error');
  signupMessage.classList.remove('success','error');
}

// Admin redirect
loginMobileInput.addEventListener('input', () => {
  if(loginMobileInput.value.trim().toLowerCase() === "burizaemon"){
    window.location.href = "admin.html";
  }
});

// Mobile validator
function isValidIndianMobile(number){
  return /^[6-9]\d{9}$/.test(number);
}

// Login API
loginForm.addEventListener('submit', async e => {
  e.preventDefault();
  clearMessages();
  const mobile = loginMobileInput.value.trim();
  const password = document.getElementById('loginPassword').value.trim();

  if(!mobile || !password){
    loginMessage.textContent = "Please fill all fields";
    loginMessage.classList.add('error');
    return;
  }
  if(!isValidIndianMobile(mobile)){
    loginMessage.textContent = "Invalid mobile number";
    loginMessage.classList.add('error');
    return;
  }

  try {
    const res = await fetch(`${API_BASE}/auth/login`, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({mobile,password})
    });
    const data = await res.json().catch(()=>null);

    if(!res.ok){
      loginMessage.textContent = data?.message || "Login failed";
      loginMessage.classList.add('error');
      stopTimerAndLines();
      return;
    }

    localStorage.setItem('token', data.token);
    localStorage.setItem('mobile', data.user.mobile);
    localStorage.setItem('isAdmin', data.user.isAdmin);

    loginMessage.textContent = 'Login successful! Redirecting...';
    loginMessage.classList.add('success');
    stopTimerAndLines();

    setTimeout(()=>window.location.href='dashboard.html', 1200);
  } catch(err) {
    loginMessage.textContent = "Network error, please check console.";
    loginMessage.classList.add('error');
    stopTimerAndLines();
  }
});

// Signup API
signupForm.addEventListener('submit', async e => {
  e.preventDefault();
  clearMessages();
  const mobile = document.getElementById('signupMobile').value.trim();
  const password = document.getElementById('signupPassword').value.trim();
  const confirmPassword = document.getElementById('signupConfirmPassword').value.trim();

  if(!mobile || !password || !confirmPassword){
    signupMessage.textContent = "Please fill all fields";
    signupMessage.classList.add('error');
    return;
  }
  if(!isValidIndianMobile(mobile)){
    signupMessage.textContent = "Invalid mobile number";
    signupMessage.classList.add('error');
    return;
  }
  if(password !== confirmPassword){
    signupMessage.textContent = "Passwords do not match";
    signupMessage.classList.add('error');
    return;
  }

  try {
    const res = await fetch(`${API_BASE}/auth/signup`, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({mobile,password})
    });
    const data = await res.json().catch(()=>null);

    if(!res.ok){
      signupMessage.textContent = data?.message || "Signup failed";
      signupMessage.classList.add('error');
      stopTimerAndLines();
      return;
    }

    signupMessage.textContent = "Signup successful! Please login.";
    signupMessage.classList.add('success');
    stopTimerAndLines();

    setTimeout(()=>{ signupForm.style.display='none'; loginForm.style.display='flex'; clearMessages(); },2000);
  } catch(err){
    signupMessage.textContent = "Network error, please check console.";
    signupMessage.classList.add('error');
    stopTimerAndLines();
  }
});

// Timer + Lines
function startTimerAndLines() {
  processingDiv.style.display = 'block';
  contactMsg.style.display = 'none';
  lineIndex = 0;
  fadingLinesDiv.textContent = "";

  if (!isTimerRunning) {
    isTimerRunning = true;
    let timeLeft = 60;
    countdown = setInterval(() => {
      timeLeft--;
      document.getElementById('timer').textContent = timeLeft;
      if(timeLeft <= 0) {
        stopTimerAndLines();
        contactMsg.style.display = "block";
      }
    }, 1000);

    lineTimer = setInterval(() => {
      fadingLinesDiv.textContent = lines[lineIndex];
      lineIndex = (lineIndex + 1) % lines.length;
    }, 1500);
  }
}


function stopTimerAndLines() {
  clearInterval(countdown);
  clearInterval(lineTimer);
  countdown = null;
  lineTimer = null;
  isTimerRunning = false;
  processingDiv.style.display = 'none';
  fadingLinesDiv.textContent = "";
}

loginBtn.addEventListener('click', startTimerAndLines);
signupBtn.addEventListener('click', startTimerAndLines);

</script>
</body>
</html>
